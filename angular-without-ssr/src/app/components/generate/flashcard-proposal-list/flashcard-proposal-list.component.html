<div class="flashcard-proposals">
  <!-- Komunikat gdy brak propozycji -->
  <div *ngIf="proposals.length === 0" class="text-center py-8 text-gray-500">
    <p class="text-lg">Brak propozycji fiszek do wyświetlenia</p>
    <p class="text-sm mt-2">Wygeneruj fiszki, aby zobaczyć propozycje</p>
  </div>

  <!-- Grid z kartami propozycji fiszek -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" *ngIf="proposals.length > 0">
    <div *ngFor="let proposal of proposals; let i = index" class="col-span-1">
      <p-card styleClass="h-full shadow-md hover:shadow-lg transition-shadow duration-200">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-3 text-white font-semibold">
            Propozycja #{{ i + 1 }}
          </div>
        </ng-template>

        <div class="p-2">
          <div class="mb-4">
            <h4 class="text-sm font-semibold text-gray-500 mb-1">Przód:</h4>
            <p class="text-gray-800 p-2 bg-gray-50 rounded min-h-[60px]">{{ proposal.front }}</p>
          </div>

          <div>
            <h4 class="text-sm font-semibold text-gray-500 mb-1">Tył:</h4>
            <p class="text-gray-800 p-2 bg-gray-50 rounded min-h-[60px]">{{ proposal.back }}</p>
          </div>
        </div>

        <ng-template pTemplate="footer">
          <div class="flex justify-between">
            <p-button
              icon="pi pi-check"
              styleClass="p-button-success p-button-sm"
              (onClick)="onAccept(proposal)"
              pTooltip="Akceptuj fiszkę"
              tooltipPosition="top">
            </p-button>

            <p-button
              icon="pi pi-pencil"
              styleClass="p-button-primary p-button-sm"
              (onClick)="openEditDialog(proposal)"
              pTooltip="Edytuj fiszkę"
              tooltipPosition="top">
            </p-button>

            <p-button
              icon="pi pi-times"
              styleClass="p-button-danger p-button-sm"
              (onClick)="onReject(proposal)"
              pTooltip="Odrzuć fiszkę"
              tooltipPosition="top">
            </p-button>
          </div>
        </ng-template>
      </p-card>
    </div>
  </div>

  <!-- Licznik propozycji -->
  <div class="mt-6 text-right text-sm text-gray-500" *ngIf="proposals.length > 0">
    Liczba propozycji: <span class="font-semibold">{{ proposals.length }}</span>
  </div>

  <!-- Dialog edycji fiszki -->
  <p-dialog
    [(visible)]="editDialogVisible"
    [style]="{width: '500px'}"
    [modal]="true"
    [draggable]="false"
    [resizable]="false"
    header="Edytuj fiszkę">

    <div class="p-fluid">
      <div class="field mb-4">
        <label for="front" class="block mb-2 font-medium">Przód fiszki</label>
        <textarea
          id="front"
          pTextarea
          [(ngModel)]="editedProposal.front"
          [autoResize]="true"
          rows="3"
          class="w-full">
        </textarea>
      </div>

      <div class="field">
        <label for="back" class="block mb-2 font-medium">Tył fiszki</label>
        <textarea
          id="back"
          pTextarea
          [(ngModel)]="editedProposal.back"
          [autoResize]="true"
          rows="3"
          class="w-full">
        </textarea>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="flex justify-end gap-2">
        <p-button
          label="Anuluj"
          icon="pi pi-times"
          styleClass="p-button-text"
          (onClick)="closeEditDialog()">
        </p-button>
        <p-button
          label="Zapisz"
          icon="pi pi-check"
          (onClick)="saveEdit()">
        </p-button>
      </div>
    </ng-template>
  </p-dialog>
</div>